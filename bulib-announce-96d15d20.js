import{h as e}from"./lit-html-2435d3b6.js";import{L as s}from"./lit-element-fdaadb84.js";const t=864e5;function i(e){console.log("_storageUtility) "+e)}const a="1ElW0CUOV3LvcHuYxK2BZfFjo65a-XDrlNJtnrelA6tM",o={"primo-BU":0,primo:1,"primo-BULAW":2,"primo-journals":3,"primo-test":4,"primo-ISL":5,testing:6,wordpress:7,libguides:8,libcal:9,libanswers:10,"libanswers-business":11,"libanswers-spring2020":12,all:13},n=e`
  <style type="text/css">
    /* site-specific code for primo's announce-banner.js - adds padding below the search bar */ 
    prm-search-bar { padding-bottom: var(--primo-announce-padding, 60px); }
    .__xs prm-search-bar, .__sm prm-search-bar { padding-bottom: var(--primo-announce-padding-small, 68px); }
  </style>
`;window.customElements.define("bulib-announce",class extends s{createRenderRoot(){return this}static get properties(){return{code:{type:String},message:{type:String},cta_text:{type:String},cta_url:{type:String},severity:{type:String},dismissed:{type:Boolean,reflect:!0},debug:{type:Boolean},prevent_action:{type:Boolean}}}connectedCallback(){if(super.connectedCallback(),this.code in o){if(this._logToConsole(`code '${this.code}' in codes_that_map dictionary.`),this.prevent_action)return void this._logToConsole("'prevent_action' stopped the API from being called!");this.dismissed=!0,this._logToConsole(`making a call to the SheetsAPI for '${this.code}'.`);let e=o[this.code];fetch("https://spreadsheets.google.com/feeds/list/"+a+"/1/public/values?alt=json",{method:"GET",mode:"cors",cache:"no-store"}).then(e=>e.json()).then(s=>s.feed.entry[e]).then(e=>this._setDataHelperWithDataFromAPI(e))}}_setDataHelperWithDataFromAPI(e){this._logToConsole(`'show_banner' in the google sheets for '${this.code}' is '${e.gsx$showbanner.$t}'.`),"TRUE"==e.gsx$showbanner.$t&&(this.dismissed=!1,this.removeAttribute("dismissed"));let s=e.gsx$messagetext.$t;s.length>0&&(this.message=s),this.cta_url=e.gsx$messagelink.$t,this.severity=e.gsx$messageseverity.$t||"info",this.cta_text=e.gsx$ctatext.$t}render(){let s="";switch(this.severity){case"success":s="check_circle";break;case"alert":s="announcement";break;case"warn":s="report_problem";break;case"info":default:s="info"}let t=this.message?this.message.replace(/&#39;/g,"'"):"Please standby while we address an ongoing issue, and email 'ask@bu.edu' if the problem persists";return e`
      ${!window.location.pathname.includes("primo-explore")||!this.debug&&this._getDismissedValue()?e``:n}
      <div class="announce-banner${null!=this.severity?" "+this.severity:""}" disabled="${this._getDismissedValue()}">
        <i class="material-icons">${s}</i>
        <span class="message">${t}</span>
        ${this.cta_url?e`<span class="cta"><a href="${this.cta_url}">${this.cta_text}</a></span>`:""}
        <button type="button" @click="${e=>this._toggleDismissed()}">
          <i class="material-icons">close</i>&nbsp;<span class="txtv">DISMISS</span>
        </button>
      </div>
    `}_getDismissedValue(){return this.hasAttribute("dismissed")?this.hasAttribute("dismissed")&&"false"!==this.getAttribute("dismissed"):function(e,s){let a=s||!1;try{let o=localStorage.getItem(e),n=localStorage.getItem(e+"-when");o&&n&&(Date.now()-n<t?(a="true"==localStorage.getItem(e),i(`unexpired '${e}' value of '${o}' read from localStorage`)):(localStorage.removeItem(e),localStorage.removeItem(e+"-when"),i(`expired '${e}*' values have been removed. will be sending fallback of '${s}'`)))}catch(t){i(`exception trying to get item '${e}' from localStorage: '${t.message}'. returning fallback '${s}' instead`),a=s||!1}finally{return a}}(this._dismissedId(),!1)||!1}_dismissedId(){let e="announcement-dismissed";try{e+="-"+this.code}catch(e){this._logToConsole("error slugifying message to get new id: "+e.message)}return e}_toggleDismissed(){let e=this._getDismissedValue();this.setAttribute("dismissed",!e),this._logToConsole(`dismiss clicked, session's' '${this._dismissedId()}' value '${e}'->'${this._getDismissedValue()}'`),this.requestUpdate("dismissed",e),function(e,s){try{localStorage.setItem(e,s),localStorage.setItem(e+"-when",Date.now()),i(`key '${e}' successfully set to value '${s}'.`)}catch(e){i("exception trying to setItem in localStorage: "+e.message)}}(this._dismissedId(),!e)}_logToConsole(e){this.debug&&console.log("bulib-announce) "+e)}});
//# sourceMappingURL=bulib-announce-96d15d20.js.map
