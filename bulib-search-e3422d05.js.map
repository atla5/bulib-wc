{"version":3,"file":"bulib-search-e3422d05.js","sources":["../src/search/search_options.js","../src/search/search.js","../src/search/bulib-search.js"],"sourcesContent":["/** data on the overall search sources we have available to search on */\nexport const search_options = [\n  {\"value\":\"help\",        \"name\":\"Help Topics\",              \"placeholder\": \"Search for help topics\",           \"domain\":\"https://askalibrarian.bu.edu/search/?t=0&q=\"},\n  {\"value\":\"help-spr20\",  \"name\":\"Spring 2020 FAQs\",         \"placeholder\": \"Search for Spring 2020 FAQs\",      \"domain\":\"https://askalibrarian.bu.edu/spring2020/search/?t=0&g=7265&q\"},\n  {\"value\":\"pardee-help\", \"name\":\"Business FAQs\",            \"placeholder\": \"Search for business help topics\",  \"domain\":\"https://askalibrarian.bu.edu/businessFAQs/search/?t=0&q=\"},\n  {\"value\":\"primo\",       \"name\":\"BU Libraries Search\",      \"placeholder\": \"Search library resources\",         \"domain\":\"https://buprimo.hosted.exlibrisgroup.com/primo-explore/search?vid=BU&institution=BOSU&search_scope=default_scope&highlight=true&lang=en_US&query=any,contains,\"},\n  {\"value\":\"wp\",          \"name\":\"BU Libraries Site\",        \"placeholder\": \"Search library info/services\",     \"domain\":\"https://search.bu.edu/?site=www.bu.edu%2Flibrary&q=\"},\n  {\"value\":\"industries\",  \"name\":\"Industry Survey Locator\",  \"placeholder\": \"Search for industry surveys\",      \"domain\":\"https://buprimo.hosted.exlibrisgroup.com/primo-explore/search?vid=ISL&institution=BOSU&search_scope=default_scope&highlight=true&lang=en_US&query=any,contains,\"},\n  {\"value\":\"guides\",      \"name\":\"Library Guides\",           \"placeholder\": \"Search research guides\",           \"domain\":\"http://library.bu.edu/srch.php?q=\"},\n  {\"value\":\"openbu\",      \"name\":\"Open BU\",                  \"placeholder\": \"Search BU Digital Collections\",    \"domain\":\"https://open.bu.edu/discover?query=\"},\n  {\"value\":\"db\",          \"name\":\"BU Databases\",             \"placeholder\": \"Search for databases\",             \"domain\":\"http://library.bu.edu/az.php?q=\"},\n  {\"value\":\"worldcat\",    \"name\":\"OCLC WorldCat\",            \"placeholder\": \"BU Libraries Search\",              \"domain\":\"https://bu.on.worldcat.org/search?queryString=\"},\n  {\"value\":\"directory\",   \"name\":\"Staff Directory\",          \"placeholder\": \"Search for people at BU\",          \"domain\":\"https://www.bu.edu/phpbin/directory/?q=\"},\n  {\"value\":\"hgar\",        \"name\":\"Archival Research Center\", \"placeholder\": \"Search the BU Archive\",            \"domain\":\"http://archives.bu.edu/search/?search=SEARCH&query=\"}\n];","import {LitElement, html, css} from 'lit-element/lit-element';\n\nimport {search_options} from './search_options';\nimport {sendGAEvent} from '../_helpers/google_analytix';\n\nconst ENTER_KEY_VALUE = 13;\n\nconst search_option_codes = search_options.map( x => x.value );\n\n/** move from 'code' string to option object (with backup) */\nconst _getOptionFromCode = function(code, lsOptions){\n  if(!lsOptions || !lsOptions.length){ lsOptions = search_options; }\n  if(!code && lsOptions && lsOptions.length >=1){ return lsOptions[0]; }\n  \n  for(let i=0; i<lsOptions.length; i++){\n    let searchOption = lsOptions[i];\n    if(searchOption[\"value\"] === code){ return searchOption; }\n  }\n  return (lsOptions && lsOptions.length == 0)? \"\" : lsOptions[0];\n};\n\n/** helper calling _getOptionFromCode  */\nconst handleSearchSelect = function(event, defaultCode=\"primo\"){\n  return event.target.defaultValue || defaultCode;\n};\n\n/** context-sensitive search form allowing you to search across multiple 'search_options' */\nexport default class BULibSearch extends LitElement {\n\n  constructor(){ \n    super(); \n    this._options = [];\n    this._selected = {};\n  }\n\n  /** allow consumer to set the options available in the dropdown, and which one is selected */\n  static get properties() {\n    return {\n      /** selected search source (defaulted to first option) */\n      str_selected: {type: String},\n      /** search sources included in the dropdown (defaulted to just 'primo') */\n      str_options: {type: String},\n      /** classes added to the search `<button>` */\n      search_btn_classes: {type: String},\n      \n      /** [debugging] log actions to the console  */\n      debug: {type: Boolean},\n      /** [debugging] prevent search button from executing and updating the window location */\n      prevent_action: {type: Boolean}\n    };\n  }\n\n  static get styles(){\n    return [\n      css`\n        .bulib-search-wrapper {\n          width: 100%;\n          background-color: var(--color-primary-background, #212121);\n          background: linear-gradient(var(--color-primary-background-dark), var(--color-primary-background-light));\n          border-radius: 4px;\n          font-family: 'Benton', sans-serif !important;\n        }\n        #bulib-search { \n          display: flex;\n          flex-wrap: wrap;\n        }\n        .search-box, .search-options {\n          margin: 0.2rem 0.4rem; \n        }\n        .search-box {\n          display: flex; \n          flex: auto;\n          max-width: 750px;\n        }\n        .search-box > input {\n          flex: 80%;\n          border-top-left-radius: 4px;\n          border-bottom-left-radius: 4px;\n          border: 0px;\n          padding-left: 6px;\n        }\n        .search-options {\n          margin-top: var(--bulib-search-options-margin);\n          margin-bottom: var(--bulib-search-options-margin);\n          padding-top: var(--bulib-search-options-padding, 10px);\n          color: var(--color-primary-text-light, white);\n          flex: auto;\n        }\n        .search-options > label {\n          margin-right: 0.5rem;\n          padding-left: 0.5rem;\n          font-size: var(--bulib-search-options-label-size, medium);\n          cursor: pointer;\n        }\n        input[type=radio] {\n          cursor: pointer;\n          margin-right: 7px;\n        }\n        button {\n          background-color: var(--color-button-background); \n          color: var(--color-button-text, white); \n          cursor: pointer;\n          border-top-right-radius: 4px;\n          border-bottom-right-radius: 4px;\n          border: 0px;\n          font-family: 'Source Sans Pro';\n        }\n        button:hover, button:focus, button:active { \n          background-color: var(--color-button-background-dark, #1B598C);\n         }\n        .hidden { display: none; }\n\n        /* medium-sized screen and above */\n        @media only screen and (min-width: 300px){\n          #bulib-search { padding: var(--bulib-search-padding, 10px); }\n          .search-box > input, input[type=radio] { \n            font-size: medium; \n          }\n        }\n      `\n    ]\n  }\n\n  render() {\n    this._setSelectedOptions();\n    let hidden_html = (!this._options || this._options.length <= 1)? \" hidden\": \"\";\n    \n    return html`\n      <div class=\"bulib-search-wrapper\">\n        <div id=\"bulib-search\">\n          <div class=\"search-box\">\n            <input type=\"text\" id=\"search-query-input\" placeholder=\"${this._selected[\"placeholder\"]}\" \n              @keypress=\"${(e) => this._handleSearchEnter(e)}\">\n            <button type=\"submit\" title=\"Search ${this._selected[\"name\"]}\" class=\"${this.search_btn_classes}\" \n              @click=\"${(e) => this._doSearch()}\" style=\"margin-left: 0px;\">\n              <!-- material-icon svg from https://material.io/resources/icons/?icon=search&style=baseline -->\n              <svg xmlns=\"http://www.w3.org/2000/svg\" style=\"padding-top: 2px;\" width=\"30\" height=\"30\" fill=\"white\" viewBox=\"0 0 24 24\">\n                <path font-weight=\"bold\" d=\"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z\"/>\n                <path d=\"M0 0h24v24H0z\" fill=\"none\"/>\n              </svg>\n            </button>\n          </div>\n          <div class=\"search-options${hidden_html}\">\n            ${this._options.map((o) => html`\n              <label>\n                ${this._selected[\"value\"] == o.value\n                  ? html`<input type=\"radio\" name=\"source\" value=\"${o.value}\" checked\n                            @change=\"${(e) => this.str_selected = handleSearchSelect(e)}\"\n                            @keypress=\"${(k) => this._handleSearchEnter(k)}\">${o.name}` \n                  : html`<input type=\"radio\" name=\"source\" value=\"${o.value}\"\n                            @change=\"${(e) => this.str_selected = handleSearchSelect(e)}\"\n                            @keypress=\"${(k) => this._handleSearchEnter(k)}\">${o.name}`\n                }\n              </label>`\n            )}\n          </div>\n        </div>\n      </div>\n    `;\n  }\n\n  /** set display options on user input (if present) */\n  _setSelectedOptions(){\n    \n    // try to set 'options' and 'selected' based on user input (with fallbacks) \n    this._options = []; this._selected = {};\n    if(!this.str_options || this.str_options === \"\"){ \n      this.str_options = [\"primo\"]; this.str_selected = \"primo\";\n    }\n      \n    let i, option, optionCode;\n    let selectedOptionCodes = this.str_options.includes(\" \")? this.str_options.split(\" \") : [this.str_options];\n    for(i=0; i<selectedOptionCodes.length; i++){\n      optionCode = selectedOptionCodes[i];\n      if(optionCode && search_option_codes.includes(optionCode)){ \n        option = _getOptionFromCode(optionCode);\n        if(option){ this._options.push(option); }\n      }\n    }\n\n    // set 'str_selected', defaulting to the first 'option'\n    this._selected = _getOptionFromCode(this.str_selected, this._options); \n  }\n\n  /** perform a search for the input query on the selected database */\n  _doSearch(){\n    // obtain values required for the search from the input and currently selected option.\n    let userInputElem = this.shadowRoot.querySelector(\"input#search-query-input\");\n    let query = userInputElem ? userInputElem.value : \"\";\n\n    // track and store the selected option and its information\n    let option = (Object.keys(this._selected).length > 0) ? this._selected : this._options[0];\n    let site = option[\"value\"];\n    let domain = option[\"domain\"] || \"\";\n\n    //conditionally log and/or perform search\n    let domain_to_print = domain.length > 80? domain.substring(0,80) + \"...\" : domain;\n    this._logToConsole(`searching '${site}' for query: '${query}' on domain: '${domain_to_print}'`);\n    if(!this.prevent_action === true){ \n      sendGAEvent(\"bulib-search\", site, query);\n      window.location = domain + encodeURIComponent(query); \n    }\n  }\n  \n  /** call this._doSearch() if key that user pressed is ENTER */ \n  _handleSearchEnter(event){\n    if(event.keyCode && event.keyCode === ENTER_KEY_VALUE){ this._doSearch(); }\n  }\n  \n  _logToConsole(message){\n    if(this.debug){ console.log(\"bulib-search) \" + message); }\n  }\n\n}","import BULibSearch from './search';\n\nwindow.customElements.define(\"bulib-search\",BULibSearch);"],"names":["search_options","ENTER_KEY_VALUE","search_option_codes","map","x","value","_getOptionFromCode","code","lsOptions","length","i","searchOption","handleSearchSelect","event","defaultCode","target","defaultValue","customElements","define","LitElement","constructor","_options","_selected","str_selected","type","String","str_options","search_btn_classes","debug","Boolean","prevent_action","css","render","_setSelectedOptions","hidden_html","this","html","e","_handleSearchEnter","_doSearch","o","k","name","option","optionCode","selectedOptionCodes","includes","split","push","userInputElem","shadowRoot","querySelector","query","Object","keys","site","domain","domain_to_print","substring","_logToConsole","sendGAEvent","window","location","encodeURIComponent","keyCode","message","console","log"],"mappings":"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"}